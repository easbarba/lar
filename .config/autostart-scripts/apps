#!/usr/bin/env bash

# Description: auto-start list of software toolings
DEPS=(pgrep bash feh)
e_checkdeps ${DEPS[@]}

# * Guards

[ "$DESKTOP_SESSION" == "plasma" ] && exit
[ "$DESKTOP_SESSION" == "gnome" ] && exit

# * Lists

LOCAL_BIN="$HOME/.local/bin"

tools=(/usr/bin/udiskie /usr/bin/mpd)

apps=("$LOCAL_BIN/e_emacs" "$LOCAL_BIN/e_wall" /usr/bin/mate-terminal
      /usr/bin/atril /usr/bin/picom)

# * Helpers

not_found() {
  [[ ! -x $(command -v "$1") ]]
}

is_running() {
  [[ $(pgrep -f "$1") ]]
}

run() {
  "$1" &
}

autostart() {
  local apps=("$@")

  for app in "${apps[@]}"; do
    not_found "$app" && continue
    is_running "$app" && continue
    run "$app"
  done
}

# * Run

autostart "${tools[@]}"
autostart "${apps[@]}"
