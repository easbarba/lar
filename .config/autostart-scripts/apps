#!/usr/bin/env bash

# Description: auto-start list of software toolings
# Deps: pgrep, command, bash4

# * Guards

[ "$DESKTOP_SESSION" == "plasma" ] && exit
[ "$DESKTOP_SESSION" == "gnome" ] && exit

# * Lists

tools=(/usr/bin/udiskie /usr/bin/unclutter /usr/bin/nm-applet /usr/bin/mpd
       /usr/bin/blueman-applet /usr/bin/mate-power-manager /usr/bin/picom) #ibus-daemon

apps=(/usr/bin/emacs /usr/bin/alacritty /usr/bin/firefox /usr/bin/atril
      /usr/bin/parcellite)

# * Utils, Helps

not_found()
{
    [[ ! -x $(command -v "$1") ]];
}

is_running()
{
    [[ $(pgrep -f "$1") ]];
}

run()
{
    "$1" &
}

autostart()
{
    local apps=("$@")

    for app in "${apps[@]}"; do
	  not_found "$app" && continue
	  is_running "$app" && continue
	  run "$app"
    done
}

# * Run

autostart "${tools[@]}"
autostart "${apps[@]}"
