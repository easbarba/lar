#!/usr/bin/env bash

# Debug Options
set -euo pipefail

deps=(npm)
s-checkdeps "${deps[@]}"

_base() {
	s-echo "Base - Installing fundamental packages"

	local packages=(npm)

	local command="npm install --global"
	s-dolist "$command" "${packages[@]}"

	local command="npm update --global"
	s-dolist "$command" "${packages[@]}"
}

_tools() {
	s-echo "Javascript Toolings packages"

	local packages=(js-beautify fx stylelint stylelint-config-standard)

	local command="npm install --global"
	s-dolist "$command" "${packages[@]}"

	local command="npm update --global"
	s-dolist "$command" "${packages[@]}"
}

_typescript() {
	s-echo "TypeScript packages"

	local packages=(typescript typescript-language-server)

	local command="npm install --global"
	s-dolist "$command" "${packages[@]}"

	local command="npm update --global"
	s-dolist "$command" "${packages[@]}"
}

_servers() {
	s-echo "LSP Servers packages"

	local packages=(bash-language-server yaml-language-server
		vscode-json-languageserver typescript-language-server
		vscode-html-languageserver-bin vscode-css-languageserver-bin)

	local command="npm install --global"
	s-dolist "$command" "${packages[@]}"

	local command="npm update --global"
	s-dolist "$command" "${packages[@]}"
}

_langs() {
	s-echo "Programming Languages toolings"

	local packages=(lua-fmt)

	local command="npm install --global"
	s-dolist "$command" "${packages[@]}"

	local command="npm update --global"
	s-dolist "$command" "${packages[@]}"
}

# * RUN

_base
_tools
_servers
_typescript
_langs
