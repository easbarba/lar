#!/usr/bin/env bash

# debug options
set -euo pipefail

DEPS=(emacs)
s-checkdeps "${DEPS[@]}"

MX_HOME="$HOME/.config/emacs"

s-echo "Doom Emacs - Install/Upgrade."

wipe() { rm -rf ~/.emacs.d; }
grab() { git clone --depth 1 https://github.com/hlissner/doom-emacs "$MX_HOME"; }
install() { "$MX_HOME"/bin/doom install; }
sync() { doom sync; }
upgrade() { doom upgrade; }
upgrade-packs() { doom upgrade --packages; }

# * RUN
wipe
[[ ! -x "$MX_HOME"/bin/doom ]] && grab && install
upgrade
