#!/usr/bin/env bash

# debug options
set -euo pipefail

DEPS=(emacs git doom)
s-checkdeps "${DEPS[@]}"

s-echo "Doom Emacs - Install/Upgrade."

EMACS_D_HOME="$HOME/.emacs.d"
[[ -d $EMACS_D_HOME ]] && rm -rf "$EMACS_D_HOME"

DOOM_HOME="$HOME/.config/emacs"
[[ ! -x "$DOOM_HOME"/bin/doom ]] && {

    git clone --depth 1 https://github.com/hlissner/doom-emacs "$DOOM_HOME"
    "$DOOM_HOME"/bin/doom install
}

doom sync
doom upgrade
doom upgrade --packages
