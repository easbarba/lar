#!/usr/bin/env bash

# DEBUG OPTIONS
set -euo pipefail

DISTRO=$(grep '^NAME=' /etc/os-release | cut -f2 -d"=" | tr -d '"')
DEPS=(sudo cp grep cut tr distro floss cejo emacs guix)
e_checkdeps "${DEPS[@]}"

e_echo "Upgrading system."
distro update
distro upgrade

e_guix

e_echo "FLOSS projects"
floss grab
floss archive
cp -rpv $HOME/Downloads/archived/* /media/$USER/MACHO/dots

e_doom
e_ruby
e_js

e_echo "Building Nightly Emacs"
[[ $DISTRO != "Arch Linux" ]] && cejo project emacs
