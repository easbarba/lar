#!/usr/bin/env bash

# Debug Options
set -euo pipefail

DEPS=(sudo apt bash)
s-checkdeps "${DEPS[@]}"

COMMAND='sudo apt-get install'

_postgres() {
    [[ -x $(command -v psql) ]] && return

    _install() {
        packages=(postgresql postgresql-contrib)
        s-dolist "$COMMAND" "${packages[@]}"
    }

    _install
}

_emacs() {
    packages=(emacs libgccjit-11-dev libjansson-dev libjansson4 libwebkit2gtk-4.0-dev)
    s-dolist "$COMMAND" "${packages[@]}"
}

_langs() {
    packages=(golang python3-pip lua5.4 lua-check ruby-dev libssl-dev clangd) # libfixposix-dev
    s-dolist "$COMMAND" "${packages[@]}"
}

_programming() {
    packages=(jq git-email subversion mercurial libpq-dev editorconfig gnome-keyring direnv)
    s-dolist "$COMMAND" "${packages[@]}"
}

# RUN
_main() {
    _postgres
    _emacs
    _langs
    _programming
}

main
