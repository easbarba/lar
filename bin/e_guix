#!/usr/bin/env bash

# * Debug Options
set -euo pipefail

# * Information
# Site: https://guix.gnu.org/

# * PATH
export GUIX_LOCPATH="$HOME/.guix-profile/lib/locale"

keys()
{
    wget "https://sv.gnu.org/people/viewgpg.php?user_id=127547" -qO - | sudo -i gpg --import -
}

get()
{
    local script=https://git.savannah.gnu.org/cgit/guix.git/plain/etc/guix-install.sh
    wget -P /tmp $script
}

install()
{
    [[ -x $(command -v guix) ]] && return

    sudo bash /tmp/guix-install.sh
}

update()
{
    guix pull
    guix upgrade
}

packages()
{
    local packages=(glibc-utf8-locales font-gnu-freefont-ttf icecat)

    for pack in "${packages[@]}"
    do
	guix install "$pack"
    done
}

# * RUN

keys
get
install
update
packages
